<%- include('./layouts/header') %>
<%- include('./layouts/navbar') %>

<!-- ✅ MAIN CONTENT -->
<main class="main-content">
  <div class="container-fluid">
    <!-- ✅ Page Title -->
    <div class="text-center mb-5">
      <h2 class="fw-bold text-success">
        <i class="fas fa-cogs me-2"></i> Landing Page Content Management
      </h2>
      <p class="text-muted">Manage your banner and gallery images here</p>
    </div>

    <!-- ✅ Banner Upload -->
    <div class="card border-0 shadow-lg mb-5">
      <div class="card-header bg-success text-white fw-bold">
        <i class="fas fa-image me-2"></i> Banner Image
      </div>
      <div class="card-body text-center">
        <% if (siteContent && siteContent.bannerImage) { %>
          <img src="/uploads/<%= siteContent.bannerImage %>" 
               class="img-fluid rounded mb-4 border" 
               style="max-height: 300px; object-fit: cover;" 
               alt="Banner">
        <% } else { %>
          <p class="text-muted">No banner uploaded yet.</p>
        <% } %>

        <form action="/admin/site-content/banner" method="POST" enctype="multipart/form-data" class="d-flex flex-column align-items-center">
          <div class="mb-3 w-100 w-md-50">
            <input type="file" name="banner" class="form-control" required>
          </div>
          <button type="submit" class="btn btn-success px-4">
            <i class="fas fa-upload me-1"></i> Upload Banner
          </button>
        </form>
      </div>
    </div>

    <!-- ✅ Gallery Management -->
    <div class="card border-0 shadow-lg">
      <div class="card-header bg-success text-white fw-bold">
        <i class="fas fa-images me-2"></i> Gallery
      </div>
      <div class="card-body">
        <!-- Upload Form -->
        <form action="/admin/site-content/gallery" method="POST" enctype="multipart/form-data" class="mb-4">
          <div class="row g-3 align-items-center">
            <div class="col-12 col-md-5">
              <input type="file" name="gallery" class="form-control" required>
            </div>
            <div class="col-12 col-md-5">
              <input type="text" name="caption" class="form-control" placeholder="Image caption (optional)">
            </div>
            <div class="col-12 col-md-2 d-grid">
              <button type="submit" class="btn btn-success">
                <i class="fas fa-plus-circle me-1"></i> Add
              </button>
            </div>
          </div>
        </form>

        <!-- Gallery List -->
        <div class="row g-4">
          <% if (siteContent && siteContent.gallery && siteContent.gallery.length > 0) { %>
            <% siteContent.gallery.forEach(img => { %>
              <div class="col-6 col-md-4 col-lg-3">
                <div class="card border-0 shadow-sm h-100">
                  <img src="/uploads/<%= img.filename %>" 
                       class="card-img-top rounded" 
                       style="height:180px; object-fit:cover;" 
                       alt="Gallery">
                  <div class="card-body text-center">
                    <p class="text-muted small mb-3"><%= img.caption %></p>
                    <form action="/admin/site-content/gallery/<%= img._id %>?_method=DELETE" method="POST">
                      <button type="submit" class="btn btn-sm btn-outline-danger">
                        <i class="fas fa-trash me-1"></i> Delete
                      </button>
                    </form>
                  </div>
                </div>
              </div>
            <% }) %>
          <% } else { %>
            <div class="col-12 text-center">
              <p class="text-muted">No gallery images yet.</p>
            </div>
          <% } %>
        </div>
      </div>
    </div>
  </div>
</main>

<%- include('./layouts/footer') %>

<!-- ✅ Custom CSS for responsive layout -->
<style>
  /* Default desktop view with sidebar */
  .main-content {
    margin-left: 250px; /* sidebar width */
    padding: 80px 20px 40px;
    background: #f9f9f9;
    min-height: 100vh;
    transition: all 0.3s ease;
  }

  /* Mobile view: no sidebar offset */
  @media (max-width: 991px) {
    .main-content {
      margin-left: 0;
      padding-top: 100px; /* bigger padding for navbar */
    }
  }
</style>
