<%- include('./layouts/navbar') %>
<main class="container">
<div class="text-center mb-4">
<h3>Point of Sale</h3>
</div>


<!-- CART -->
<div class="card mx-auto mb-4" style="max-width:600px">
<div class="card-body">
<h5 class="card-title">Current Order</h5>
<ul id="cartList" class="list-group mb-3"></ul>
<h5 class="text-end">Total: ₱<span id="total">0</span></h5>
<form method="POST" action="/pos/payment" onsubmit="return validateCart()">
<input type="hidden" name="cart" id="cartInput">
<button class="btn btn-success w-100">Proceed to Payment</button>
</form>
</div>
</div>


<!-- PRODUCTS -->
<div class="row justify-content-center">
<% products.forEach(p => { %>
<div class="col-md-3 mb-4">
<div class="card h-100" data-bs-toggle="modal" data-bs-target="#qtyModal" onclick="selectProduct('<%= p._id %>','<%= p.name %>',<%= p.price %>,<%= p.quantity %>)">
<img src="<%= p.image %>" class="card-img-top">
<div class="card-body text-center">
<h6><%= p.name %></h6>
<small>₱<%= p.price %> | Stock: <%= p.quantity %></small>
</div>
</div>
</div>
<% }) %>
</div>
</main>


<!-- QUANTITY MODAL -->
<div class="modal fade" id="qtyModal" tabindex="-1">
<div class="modal-dialog modal-dialog-centered">
<div class="modal-content">
<div class="modal-header"><h5>Select Quantity</h5></div>
<div class="modal-body">
<input type="number" id="qtyInput" class="form-control" min="1">
</div>
<div class="modal-footer">
<button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
<button class="btn btn-primary" onclick="confirmQty()">Add</button>
</div>
</div>
</div>
</div>


<script>
let cart = [];
let selectedProduct = {};


function selectProduct(id,name,price,stock){
selectedProduct = {id,name,price,stock};
</script>